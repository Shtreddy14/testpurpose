$CompObject =  Get-WmiObject -Class WIN32_OperatingSystem
$timeout = 0
$thersholdtime = 5
$memorythreshold = 75
while($timeout -lt $thersholdtime){
$Memory = ((($CompObject.TotalVisibleMemorySize - $CompObject.FreePhysicalMemory)*100)/ $CompObject.TotalVisibleMemorySize)
if ("$Memory" -gt $memorythreshold){
        start-sleep -seconds 60
        $timeout++
        if ($timeout -eq 5){
        Write-Host "Send-MailMessage -To “recipient’s email address>” -From “<sender’s email address>”  -Subject “Your message subject” -Body “Some important plain text!” -Credential (Get-Credential) -SmtpServer “<smtp server>” -Port 587"
        }
        else{
         Write-Host "Waiting for $timeout minutes"
        }   
}
else {
 Write-Host "$Memory is not greater than 75"
 exit
}
}
